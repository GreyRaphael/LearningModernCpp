# Files & Streams

- [Files \& Streams](#files--streams)
  - [Read/Write Binary file](#readwrite-binary-file)

## Read/Write Binary file

```cpp
#include <fstream>
#include <iostream>
#include <numeric>  // std::iota
#include <vector>

int main() {
    std::vector<unsigned char> v(50);
    std::iota(v.begin(), v.end(), 1);
    // example1: simple write binary file
    {
        std::ofstream ofile("sample.bin", std::ios::binary);
        if (ofile.is_open()) {
            ofile.write(reinterpret_cast<char*>(v.data()), v.size());
            ofile.close();
        }
    }
    // example2: simple read binary file
    {
        std::vector<unsigned char> v2;
        // std::ios::ate,转到文件末尾
        std::ifstream ifile("sample.bin", std::ios::ate | std::ios::binary);
        size_t readbytes = 0;
        if (ifile.is_open()) {
            auto length = static_cast<size_t>(ifile.tellg());
            // 转到文件开头
            ifile.seekg(0, std::ios_base::beg);

            v2.resize(length);

            try {
                ifile.read(reinterpret_cast<char*>(v2.data()), length);
                readbytes = static_cast<size_t>(ifile.gcount());
            } catch (std::ios_base::failure&) {
                // handle the error
            }
            ifile.close();
        }
        std::cout << "Read:" << readbytes << " Bytes\n";  // Read:50 Bytes
        for (auto& e : v2) {
            std::cout << (int)e << ',';
        }
    }
}
```