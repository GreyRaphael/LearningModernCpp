# C++17 features

- [C++17 features](#c17-features)
  - [handy features](#handy-features)

## handy features

```cpp
#include <fmt/core.h>

#include <algorithm>
#include <functional>
#include <iterator>
#include <memory>
#include <numeric>
#include <random>
#include <vector>

struct alignas(16) Vec3 {
    float x, y, z;
};

struct Student {
    int age;
    void print(double score) { fmt::println("my score={}", score); }
};

int myfunc(int x, int y) {
    return x * y;
}

int main(int argc, char const *argv[]) {
    {
        // use alingnas in SIMD
        fmt::println("Vec3 size={}", sizeof(Vec3{}));  // 16
    }
    {
        // modify the last element of emplace_back
        std::vector<std::string> v{{"moris"}, {"Tom"}};
        auto x = v.emplace_back("hello").append("cpp");
        // auto x = v.emplace_back("hello").substr(0, 3);

        fmt::println("{}", x);  // hellocpp
        for (auto &&e : v) {
            fmt::print("{}\t", e);
        }  // moris   Tom     hellocpp
    }
    {
        // sampling
        std::vector<int> v{1, 2, 3, 4, 5, 6};
        std::vector<int> out;
        std::sample(v.begin(), v.end(), std::back_inserter(out), 3, std::mt19937{std::random_device{}()});
        for (auto &&e : out) {
            fmt::print("{}\t", e);
        }  // 3 random number
    }
    {
        // some math function
        fmt::println("gcd={},lcm={}", std::gcd(12, 8), std::lcm(2, 3));  // 4, 6
        // limit value in range [0, 255]
        fmt::println("{}", std::clamp(300, 0, 255));  // 255
        fmt::println("{}", std::clamp(-1, 0, 255));   // 0
    }
    {
        // std::invoke simple func
        auto result1 = std::invoke(myfunc, 10, 20);  // 200
        // std::invoke lambda
        auto result2 = std::invoke([](int x) { return x * x * x; }, 10);  // 1000

        // std::invoke member func
        Student stu{66};
        std::invoke(&Student::print, stu, 100);  // invoke func
        // std::invoke member variable
        auto result3 = std::invoke(&Student::age, stu);  // 66

        // std::invoke member by pointer
        auto ptr = std::make_shared<Student>(88);
        std::invoke(&Student::print, ptr, 200);
        auto result4 = std::invoke(&Student::age, ptr);  // 88
    }
}
```